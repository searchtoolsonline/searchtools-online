<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Editor | Search Tools Online</title>
  <style>
    :root {
      --red: #fc0328;
      --cyan: #03fcd7;
      --dark: #111;
      --light: #fff;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", sans-serif;
    }

    body {
      background: linear-gradient(135deg, var(--red), var(--cyan));
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: var(--light);
      width: 100%;
      max-width: 1100px;
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    header {
      padding: 20px;
      text-align: center;
      background: linear-gradient(90deg, var(--red), var(--cyan));
      color: white;
    }

    header h1 {
      font-size: 1.8rem;
    }

    .editor {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      padding: 20px;
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .controls label {
      font-weight: 600;
      color: var(--dark);
    }

    input[type="file"],
    input[type="range"],
    input[type="number"] {
      width: 100%;
    }

    .btn {
      padding: 12px;
      border-radius: 30px;
      border: none;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      background: linear-gradient(90deg, var(--red), var(--cyan));
      color: white;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
    }

    .preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    canvas {
      max-width: 100%;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      width: 100%;
    }

    footer {
      padding: 15px;
      text-align: center;
      font-size: 0.9rem;
      background: #f5f5f5;
      color: #333;
    }

    .back-home {
      margin-top: 10px;
      background: linear-gradient(90deg, var(--cyan), var(--red));
    }

    @media (max-width: 768px) {
      .editor {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üñºÔ∏è Image Editor</h1>
      <p>Edit, Crop, Resize & Enhance Images Online</p>
    </header>

    <div class="editor">
      <!-- CONTROLS -->
      <div class="controls">
        <label>Upload Image</label>
        <input type="file" id="upload" accept="image/*" />

        <label>Brightness</label>
        <input type="range" id="brightness" min="-100" max="100" value="0" />

        <label>Contrast</label>
        <input type="range" id="contrast" min="-100" max="100" value="0" />

        <label>Resize Width (px)</label>
        <input type="number" id="resizeWidth" placeholder="Auto" />

        <label>Resize Height (px)</label>
        <input type="number" id="resizeHeight" placeholder="Auto" />

        <label>Rotate (degrees)</label>
        <input type="range" id="rotate" min="-180" max="180" value="0" />

        <label>Grayscale</label>
        <input type="range" id="grayscale" min="0" max="100" value="0" />

        <label>Blur</label>
        <input type="range" id="blur" min="0" max="10" value="0" />

        <button class="btn" id="editBtn">Edit Image</button>
      </div>

      <!-- PREVIEW -->
      <div class="preview">
        <canvas id="canvas"></canvas>
        <div class="actions">
          <button class="btn" id="downloadBtn">Download Image</button>
          <button class="btn back-home" onclick="window.location.href='/'">Back to Home</button>
        </div>
      </div>
    </div>

    <footer>
      ¬© Search Tools Online ‚Äì Crop Image
    </footer>
  </div>

  <script>
    // --- Elements ---
    const upload = document.getElementById("upload");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    const brightnessInput = document.getElementById("brightness");
    const contrastInput = document.getElementById("contrast");
    const rotateInput = document.getElementById("rotate");
    const grayscaleInput = document.getElementById("grayscale");
    const blurInput = document.getElementById("blur");
    const resizeWidthInput = document.getElementById("resizeWidth");
    const resizeHeightInput = document.getElementById("resizeHeight");

    const editBtn = document.getElementById("editBtn");
    const downloadBtn = document.getElementById("downloadBtn");

    let img = new Image();

    // --- Upload & initial draw ---
    upload.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        img.onload = () => {
          canvas.width = img.width;
          canvas.height = img.height;
          ctx.setTransform(1, 0, 0, 1, 0, 0);
          ctx.filter = 'none';
          ctx.drawImage(img, 0, 0);
        };
        img.src = reader.result;
      };
      reader.readAsDataURL(file);
    });

    // --- Apply edits ---
    editBtn.addEventListener("click", () => {
      if (!canvas.width || !canvas.height) return;

      const brightness = Number(brightnessInput.value);
      const contrast = Number(contrastInput.value);
      const rotate = Number(rotateInput.value);
      const grayscale = Number(grayscaleInput.value);
      const blur = Number(blurInput.value);

      const newWidth = Number(resizeWidthInput.value) || canvas.width;
      const newHeight = Number(resizeHeightInput.value) || canvas.height;

      const tempCanvas = document.createElement("canvas");
      const tempCtx = tempCanvas.getContext("2d");

      tempCanvas.width = newWidth;
      tempCanvas.height = newHeight;

      tempCtx.filter = `brightness(${100 + brightness}%) contrast(${100 + contrast}%) grayscale(${grayscale}%) blur(${blur}px)`;
      tempCtx.translate(newWidth / 2, newHeight / 2);
      tempCtx.rotate((rotate * Math.PI) / 180);
      tempCtx.drawImage(canvas, -newWidth / 2, -newHeight / 2, newWidth, newHeight);

      canvas.width = newWidth;
      canvas.height = newHeight;
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.filter = 'none';
      ctx.drawImage(tempCanvas, 0, 0);
    });

    // --- Download ---
    downloadBtn.addEventListener("click", () => {
      if (!canvas.width || !canvas.height) return;
      const link = document.createElement("a");
      link.download = "edited-image.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    });

    // --- Minimal self-tests (dev only) ---
    (function selfTests(){
      console.assert(!!canvas && !!ctx, 'Canvas context should exist');
      console.assert(editBtn && downloadBtn, 'Action buttons should exist');
    })();
  </script>
</body>
</html>
